use market;
-- 1. 회원(User)
CREATE TABLE User (
    userid VARCHAR(255) PRIMARY KEY NOT NULL,
    password VARCHAR(255) NOT NULL,
    username VARCHAR(50) NOT NULL UNIQUE,
    email VARCHAR(100) NOT NULL,
    phone VARCHAR(20),
    createddate DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- 2. 게시글(Post)
CREATE TABLE Post (
    postid INT AUTO_INCREMENT PRIMARY KEY,
    userid VARCHAR(255) NOT NULL,
    username VARCHAR(50) NOT NULL,
    state ENUM('buy', 'sell', 'community') NOT NULL,
    category VARCHAR(200) NOT NULL,
    title VARCHAR(200) NOT NULL,
    content TEXT NOT NULL,
    image VARCHAR(255),
    price INT, 
	sold ENUM('판매중', '판매완료'), 
    location VARCHAR(50) NOT NULL,
	viewcnt INT DEFAULT 0,
    createdtime DATETIME DEFAULT CURRENT_TIMESTAMP,
    updatedtime DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (userid) REFERENCES User(userid) ON DELETE CASCADE,
    FOREIGN KEY (username) REFERENCES User(username) ON DELETE CASCADE
);

-- 3. 댓글(Comment)
CREATE TABLE Comment (
    comment_id INT AUTO_INCREMENT PRIMARY KEY,
    post_id INT NOT NULL,
    user_id INT NOT NULL,
    content TEXT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (post_id) REFERENCES Post(post_id) ON DELETE CASCADE,
    FOREIGN KEY (user_id) REFERENCES User(user_id) ON DELETE CASCADE
);
